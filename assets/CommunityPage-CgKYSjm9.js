import{c as I,r as v,a0 as Q,j as e,f as A,X as O,a1 as Z,D as _,L as T,U as L,S as $,a2 as J,m as Y,a3 as ee,l as F,k as se,a4 as re,_ as G,a5 as U,a6 as te,Y as ae,d as le,u as z,B as ie,V as de,a7 as ne,a8 as oe,a9 as ce,aa as xe,ab as me,W as ge}from"./index-xgS4Epe1.js";import{S as he}from"./square-pen-B3v9sXfY.js";/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ue=I("chevron-down",be);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],fe=I("chevron-up",ye);function je({isOpen:s,onClose:o,communityId:i,communityName:b}){var m,h;const[l,g]=v.useState(""),{data:x,isLoading:y,error:r}=Q(i,s),d=((m=x==null?void 0:x.members)==null?void 0:m.filter(t=>t.name.toLowerCase().includes(l.toLowerCase())||t.id.toLowerCase().includes(l.toLowerCase())))||[],c=t=>{switch(t){case"COMMUNITY_MANAGER":return e.jsx(J,{className:"w-4 h-4 text-purple-600 dark:text-purple-400"});case"MENTOR":return e.jsx($,{className:"w-4 h-4 text-green-600 dark:text-green-400"});case"MENTEE":return e.jsx(L,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"});default:return e.jsx(L,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})}},N=t=>{switch(t){case"COMMUNITY_MANAGER":return"Manager";case"MENTOR":return"Mentor";case"MENTEE":return"Mentee";default:return t}},a=t=>t==null?void 0:t.split(" ").map(j=>j[0]).join("").toUpperCase().slice(0,2);return s?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75 dark:bg-gray-900 dark:bg-opacity-75",onClick:o}),e.jsxs("div",{className:"inline-block w-full max-w-2xl p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white dark:bg-gray-800 shadow-xl rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-blue-100 dark:bg-blue-900/20 rounded-full mr-3",children:e.jsx(A,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Community Members"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:b})]})]}),e.jsx("button",{onClick:o,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors",children:e.jsx(O,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search members...",value:l,onChange:t=>g(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"})]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:y?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(_,{text:"Loading members..."})}):r?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-red-600 dark:text-red-400",children:"Failed to load members"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:r.message})]}):d.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:l?"No members found matching your search":"No members found"})]}):e.jsx("div",{className:"space-y-2",children:d.map(t=>e.jsxs("div",{className:"flex items-center p-3 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white text-sm font-medium mr-3 flex-shrink-0",children:t.imageUrl?e.jsx("img",{src:t.imageUrl||"/placeholder.svg",alt:t.name,className:"w-full h-full object-cover"}):a(t.name)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:t.name}),c(t.role)]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsxs(T,{to:`/profile/${t.id}`,target:"_blank",className:"text-xs text-blue-600 dark:text-blue-400 hover:underline truncate",children:["@",t.id]}),e.jsx("span",{className:"text-xs text-gray-400",children:"â€¢"}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:N(t.role)})]})]}),e.jsxs("div",{className:"text-xs text-gray-400 dark:text-gray-500 flex-shrink-0",children:["Joined"," ",new Date(t.joinedAt).toLocaleDateString("en-US",{month:"short",year:"numeric"})]})]},t.id))})}),e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:[d.length," of ",((h=x==null?void 0:x.members)==null?void 0:h.length)||0," members",l&&" (filtered)"]}),e.jsx("button",{onClick:o,className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-md transition-colors",children:"Close"})]})})]})]})}):null}const V=[{step:1,title:"Send Verification Email",icon:Y,description:"Send an email to sgrowthly@gmail.com with the following information:",details:["Community name and description","Organization/school that backs your community","Official documentation proving your affiliation","Your role and position in the organization","Contact information for verification"],color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-100 dark:bg-blue-900/20"},{step:2,title:"Provide Additional Information",icon:ee,description:"If further verification is needed, we'll reply with specific requests:",details:["Additional documentation may be requested","Verification of your identity and role","Proof of community legitimacy","Official endorsement from your organization"],color:"text-orange-600 dark:text-orange-400",bgColor:"bg-orange-100 dark:bg-orange-900/20"},{step:3,title:"Verification Decision",icon:F,description:"You'll receive a final decision via email:",details:["âœ… Approval: Your community gets verified status","âŒ Rejection: Detailed explanation of the reason","ðŸ”„ Additional requirements: More information needed"],color:"text-green-600 dark:text-green-400",bgColor:"bg-green-100 dark:bg-green-900/20"}];function Ne({isOpen:s,onClose:o}){return s?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75 dark:bg-gray-900 dark:bg-opacity-75",onClick:o}),e.jsxs("div",{className:"inline-block w-full max-w-3xl p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white dark:bg-gray-800 shadow-xl rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-blue-100 dark:bg-blue-900/20 rounded-full mr-3",children:e.jsx(F,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Community Verification Process"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Follow these steps to get your community verified"})]})]}),e.jsx("button",{onClick:o,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors",children:e.jsx(O,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"mb-6 p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(se,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 mr-3 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200 mb-1",children:"Verification Requirements"}),e.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:"Only communities backed by legitimate organizations, schools, or institutions can be verified. Personal or informal communities are not eligible for verification."})]})]})}),e.jsx("div",{className:"space-y-6",children:V.map((i,b)=>{const l=i.icon;return e.jsxs("div",{className:"relative",children:[b<V.length-1&&e.jsx("div",{className:"absolute left-5 top-12 w-0.5 h-16 bg-gray-200 dark:bg-gray-600"}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full ${i.bgColor} mr-4 flex-shrink-0`,children:e.jsx(l,{className:`w-5 h-5 ${i.color}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mr-2",children:["Step ",i.step]}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white",children:i.title})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-3",children:i.description}),e.jsx("ul",{className:"space-y-1",children:i.details.map((g,x)=>e.jsxs("li",{className:"flex items-start text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("span",{className:"text-gray-400 mr-2 mt-1",children:"â€¢"}),e.jsx("span",{children:g})]},x))})]})]})]},i.step)})}),e.jsxs("div",{className:"mt-8 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Contact Information"}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-300",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),e.jsx("a",{href:"mailto:sgrowthly@gmail.com",className:"text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300 transition-colors",children:"sgrowthly@gmail.com"})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"Please allow 3-5 business days for initial review. Complex verifications may take longer."})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-end",children:e.jsx("button",{onClick:o,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors",children:"Got it, thanks!"})})]})]})}):null}function ve({community:s,userMembership:o,canViewMembers:i,canRequestJoin:b,isMember:l,isPending:g,isCommunityManager:x,isManager:y,isAdmin:r,showLeaveConfirm:d,message:c,onShowMembers:N,onJoinRequest:a,onCancelJoinRequest:m,onShowLeaveConfirm:h,onCancelLeave:t,onConfirmLeave:j,requestToJoinMutation:C,cancelJoinRequestMutation:p,leaveCommunityMutation:w}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Community Info"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Members"}),i?e.jsx("button",{onClick:N,className:"text-sm font-medium text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300 transition-colors",children:(s==null?void 0:s.memberCount)||0}):e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:(s==null?void 0:s.memberCount)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Created"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:s!=null&&s.createdAt?new Date(s.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown"})]}),(s==null?void 0:s.managerId)&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Manager"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:s.managerId})]})]})]}),!x&&!r&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"space-y-4",children:[b&&e.jsxs("button",{onClick:a,disabled:C.isPending,className:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-medium rounded-md transition-colors disabled:cursor-not-allowed",children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),C.isPending?"Requesting...":"Request to Join"]}),g&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-yellow-800 dark:text-yellow-200 font-medium",children:"Request Sent"}),e.jsx("div",{className:"text-xs text-yellow-600 dark:text-yellow-300 mt-1",children:"Waiting for approval"})]})]})})}),e.jsxs("button",{onClick:m,disabled:p.isPending,className:"w-full flex items-center justify-center px-4 py-2 border border-red-300 dark:border-red-600 text-red-700 dark:text-red-400 bg-red-50 dark:bg-red-900/20 hover:bg-red-100 dark:hover:bg-red-900/30 font-medium rounded-md transition-colors disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),p.isPending?"Canceling...":"Cancel Request"]})]}),l&&!d&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{className:"w-4 h-4 text-green-600 dark:text-green-400 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-green-800 dark:text-green-200 font-medium",children:"You're a Member"}),e.jsx("div",{className:"text-xs text-green-600 dark:text-green-300 mt-1",children:"Welcome to the community!"})]})]})}),e.jsxs("button",{onClick:h,className:"w-full flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 font-medium rounded-md transition-colors",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Leave Community"]})]}),l&&d&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-red-800 dark:text-red-200 font-medium text-center",children:"Are you sure you want to leave?"}),e.jsx("div",{className:"text-xs text-red-600 dark:text-red-300 mt-1 text-center",children:"You can rejoin anytime by sending a new request"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:j,disabled:w.isPending,className:"flex-1 flex items-center justify-center px-3 py-2 bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white text-sm font-medium rounded-md transition-colors disabled:cursor-not-allowed",children:[e.jsx(U,{className:"w-4 h-4 mr-1"}),w.isPending?"Leaving...":"Leave"]}),e.jsx("button",{onClick:t,className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 text-sm font-medium rounded-md transition-colors",children:"Cancel"})]})]})]}),c&&e.jsx("div",{className:`mt-4 rounded-md border p-3 ${c.type==="success"?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800"}`,children:e.jsx("div",{className:`text-sm text-center ${c.type==="success"?"text-green-700 dark:text-green-400":"text-red-700 dark:text-red-400"}`,children:c.text})})]})]})}function pe({community:s,isManager:o,isAdmin:i,onShowVerification:b}){var g;const l=((g=s==null?void 0:s.name)==null?void 0:g.slice(0,50))||"";return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"h-48 bg-gradient-to-r from-blue-500 to-purple-600 relative",children:[(s==null?void 0:s.cover_image)&&e.jsx("img",{src:s.cover_image||"/placeholder.svg",alt:`${l} cover`,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-20"})]}),e.jsx("div",{className:"px-6 pb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-end sm:space-x-6",children:[e.jsx("div",{className:"relative -mt-16 mb-4 sm:mb-0",children:e.jsx("div",{className:"w-32 h-32 rounded-lg border-4 border-white dark:border-gray-800 overflow-hidden bg-white dark:bg-gray-700 shadow-lg",children:s!=null&&s.imageUrl?e.jsx("img",{src:s.imageUrl||"/placeholder.svg",alt:l,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-r from-blue-500 to-purple-600 text-white text-2xl font-bold",children:l.charAt(0)})})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center space-x-3 flex-wrap",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white break-words max-w-full",children:l}),s!=null&&s.verified?e.jsxs("div",{className:"flex items-center text-blue-600 dark:text-blue-400 mt-3",children:[e.jsx(te,{className:"w-5 h-5 mr-1"}),e.jsx("span",{className:"text-sm font-medium",children:"Verified"})]}):e.jsxs("div",{className:"flex items-center space-x-2 mt-3",children:[e.jsxs("div",{className:"flex items-center text-gray-500 dark:text-gray-400",children:[e.jsx($,{className:"w-5 h-5 mr-1"}),e.jsx("span",{className:"text-sm",children:"Not verified"})]}),o&&!i&&e.jsx("button",{onClick:b,className:"text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300 text-sm font-medium transition-colors",children:"How to verify?"})]})]})}),o&&!i&&e.jsxs("div",{className:"flex items-center space-x-3 mt-4 sm:mt-0",children:[e.jsxs(T,{to:"/communities/my/manage",className:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Manage"]}),e.jsxs(T,{to:"/communities/my/settings",className:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:[e.jsx(ae,{className:"w-4 h-4 mr-2"}),"Settings"]})]})]})})]})})]})}function we({community:s}){return e.jsx("div",{className:"space-y-6",children:(s==null?void 0:s.description)&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"About"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 whitespace-pre-wrap leading-relaxed",children:s.description})]})})}function ke({services:s,isLoading:o,error:i,communityId:b}){const[l,g]=v.useState(null),x=le(),{data:y}=z(),r=y==null?void 0:y.user,d=(a,m)=>{(r==null?void 0:r.id)===m&&(r==null?void 0:r.role)==="MENTOR"?x(`/my/services/${a.id}`):(r==null?void 0:r.role)==="MENTEE"&&x(`/users/${m}/services/${a.id}/book`)},c=a=>(r==null?void 0:r.id)===a&&(r==null?void 0:r.role)==="MENTOR",N=a=>(r==null?void 0:r.role)==="MENTEE"||(r==null?void 0:r.role)==="MENTOR"&&(r==null?void 0:r.id)===a;return o?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Available Services"}),e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded mb-3"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded mb-3"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded"})]})]}):i?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Available Services"}),e.jsxs("div",{className:"text-red-500 text-sm",children:["Failed to load services: ",i.message]})]}):!s||Object.keys(s).length===0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Available Services"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"No services available in this community yet."})]}):e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Available Services"}),e.jsx("div",{className:"space-y-4",children:Object.entries(s).map(([a,m])=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[e.jsxs("button",{onClick:()=>g(l===a?null:a),className:"w-full flex items-center justify-between text-left",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"h-5 w-5 text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:c(a)?"My Services":a}),!c(a)&&(r==null?void 0:r.role)==="MENTOR"&&e.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded",children:"View only"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[m.length," service",m.length!==1?"s":""]}),l===a?e.jsx(fe,{className:"h-4 w-4 text-gray-400"}):e.jsx(ue,{className:"h-4 w-4 text-gray-400"})]})]}),l===a&&e.jsx("div",{className:"mt-3 space-y-3",children:m.map(h=>{const t=c(a),j=N(a);return e.jsxs("div",{onClick:()=>j&&d(h,a),className:`
                        rounded-lg p-3 transition-colors
                        ${j?"bg-gray-50 dark:bg-gray-700 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600":"bg-gray-100 dark:bg-gray-800 cursor-default opacity-75"}
                        ${t?"border-l-4 border-blue-500":""}
                      `,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:h.type}),t?e.jsx(he,{className:"h-4 w-4 text-blue-500"}):(r==null?void 0:r.role)==="MENTOR"?e.jsx(ie,{className:"h-4 w-4 text-gray-400"}):null]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400 mt-1",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsxs("span",{children:[h.sessionTime," minutes"]})]}),e.jsx("div",{className:"text-xs text-gray-400 mt-2",children:t?"Click to manage this service":(r==null?void 0:r.role)==="MENTEE"?"Click to book this service":"View only - Other mentor's service"})]},h.id)})})]},a))}),(r==null?void 0:r.role)==="MENTOR"&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:e.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:[e.jsx("strong",{children:"Note:"})," As a mentor, you can only manage your own services. Other mentors' services are shown for reference only."]})})]})}function Ee(){const{id:s}=de(),{data:o}=z(),[i,b]=v.useState(!1),[l,g]=v.useState(!1),[x,y]=v.useState(!1),[r,d]=v.useState(null),{data:c,isLoading:N,error:a,refetch:m}=ne(s),h=oe(),{data:t,isLoading:j,error:C}=ce(s),p=xe(),w=me();v.useEffect(()=>{if(r){const f=setTimeout(()=>{d(null)},3e3);return()=>clearTimeout(f)}},[r]);const S=()=>{p.reset(),w.reset(),h.reset()};if(N)return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:e.jsx(_,{size:"lg",text:"Loading community..."})});if(a)return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:e.jsx(ge,{title:"Community Not Found",message:a.message||"The community you're looking for doesn't exist or has been removed.",showRetry:!0,onRetry:()=>window.location.reload()})});const u=c==null?void 0:c.community,n=o==null?void 0:o.user,R=c==null?void 0:c.membershipStatus,k=(n==null?void 0:n.role)==="ADMIN",M=(n==null?void 0:n.role)==="COMMUNITY_MANAGER"&&(u==null?void 0:u.managerId)===(n==null?void 0:n.id)||k,W=(n==null?void 0:n.role)==="COMMUNITY_MANAGER",E=R==="MEMBER",q=R==="PENDING",P=E||M||k,B=E||k||M,D=((n==null?void 0:n.role)==="MENTEE"||(n==null?void 0:n.role)==="MENTOR")&&!E&&!q,H=async()=>{try{S(),d(null),await w.mutateAsync(u.id),d({type:"success",text:"âœ“ Request canceled successfully"}),await m()}catch(f){console.error("Cancel join request failed:",f),d({type:"error",text:f.message||"Failed to cancel request"})}},X=async()=>{try{S(),d(null),await p.mutateAsync(u.id),d({type:"success",text:"âœ“ Join request sent successfully!"}),await m()}catch(f){console.error("Join request failed:",f),d({type:"error",text:f.message||"Failed to send join request"})}},K=async()=>{try{S(),d(null),await h.mutateAsync(u.id),y(!1),d({type:"success",text:"âœ“ Left community successfully"}),m()}catch(f){console.error("Leave community failed:",f),d({type:"error",text:f.message||"Failed to leave community"})}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors",children:[e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx(pe,{community:u,isManager:M,isAdmin:k,onShowVerification:()=>g(!0)}),e.jsxs("div",{className:"mt-8 grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx(we,{community:u}),B&&e.jsx(ke,{services:t==null?void 0:t.services,isLoading:j,error:C})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(ve,{community:u,userMembership:R,canViewMembers:P,canRequestJoin:D,isCommunityManager:W,isMember:E,isPending:q,isManager:M,isAdmin:k,showLeaveConfirm:x,message:r,onShowMembers:()=>b(!0),onJoinRequest:X,onCancelJoinRequest:H,onShowLeaveConfirm:()=>y(!0),onCancelLeave:()=>y(!1),onConfirmLeave:K,requestToJoinMutation:p,cancelJoinRequestMutation:w,leaveCommunityMutation:h})})]})]}),i&&P&&e.jsx(je,{isOpen:i,onClose:()=>b(!1),communityId:u.id,communityName:u.name}),l&&e.jsx(Ne,{isOpen:l,onClose:()=>g(!1)})]})}export{Ee as default};
